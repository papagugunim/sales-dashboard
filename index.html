<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>롯데제과 러시아법인 - 판매 현황</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- ECharts 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- SheetJS 라이브러리 (Excel 내보내기) -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <!-- 로그인 페이지 -->
    <div id="loginPage" class="login-container">
        <button id="darkModeToggleLogin" class="dark-mode-toggle-login">다크모드</button>
        <div class="login-box">
            <div class="login-header">
                <h1>📊 판매 관리 시스템</h1>
                <p>롯데제과 러시아법인</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">사용자 ID</label>
                    <input type="text" id="username" name="username" placeholder="아이디를 입력하세요" required>
                </div>
                <div class="form-group">
                    <label for="password">비밀번호</label>
                    <input type="password" id="password" name="password" placeholder="비밀번호를 입력하세요" required>
                </div>
                <div class="form-group remember-me">
                    <label>
                        <input type="checkbox" id="rememberMe">
                        <span>로그인 상태 유지</span>
                    </label>
                </div>
                <button type="submit" class="login-btn">로그인</button>
                <div id="loginError" class="error-message" style="display: none;"></div>
            </form>
        </div>
    </div>

    <!-- 메인 대시보드 (로그인 후 표시) -->
    <div id="mainDashboard" class="container" style="display: none;">
        <header>
            <div class="lotte-brand" style="text-align: center; margin-bottom: 4px;">
                <div style="display: flex; align-items: center; justify-content: center; gap: 5px; margin-bottom: 2px;">
                    <img src="logo.png" alt="Lotte Logo" style="height: 18px; width: auto; opacity: 0.85;">
                    <span style="font-size: 1.3rem; color: #5f7d95; font-weight: 700;">롯데제과 러시아법인 판매 관리 시스템</span>
                </div>
                <div style="font-size: 0.6rem; color: #7f8c8d;">
                    v0.202512
                </div>
            </div>
            <div class="header-top">
                <div>
                    <h1>📊 판매 현황</h1>
                </div>
                <div class="user-info">
                    <span class="username-display">👤 <span id="currentUser"></span></span>
                    <button id="darkModeToggle" class="dark-mode-toggle" title="다크모드 전환">다크모드</button>
                    <button id="logoutBtn" class="logout-btn">로그아웃</button>
                </div>
            </div>
            <div class="header-info">
                <span class="update-time">판매 파일: <span id="dataFileName">-</span></span>
            </div>
        </header>

        <div class="summary-cards">
            <div class="card">
                <div class="card-title">총 판매금액</div>
                <div class="card-value" id="totalAmount">-</div>
                <div class="card-unit">백만 루블</div>
                <div class="card-subvalue" id="totalAmountKRW">-</div>
            </div>
            <div class="card">
                <div class="card-title">총 판매량</div>
                <div class="card-value" id="totalQuantity">-</div>
                <div class="card-unit">박스</div>
            </div>
            <div class="card">
                <div class="card-title">거래처 수</div>
                <div class="card-value" id="clientCount">-</div>
                <div class="card-unit">개</div>
            </div>
            <div class="card">
                <div class="card-title">평균 할인율</div>
                <div class="card-value" id="avgDiscount">-</div>
                <div class="card-unit">%</div>
            </div>
        </div>

        <!-- 보기 방식 탭 메뉴 -->
        <div class="view-tabs">
            <button class="tab-btn active" data-tab="table">
                <span class="tab-icon">📋</span>
                <span class="tab-label">테이블</span>
            </button>
            <button class="tab-btn" data-tab="chart">
                <span class="tab-icon">📈</span>
                <span class="tab-label">차트</span>
            </button>
            <button class="tab-btn" data-tab="report">
                <span class="tab-icon">📄</span>
                <span class="tab-label">보고서</span>
            </button>
        </div>

        <div class="filters">
            <!-- 기간 필터 -->
            <div class="filter-group">
                <label>기간(월):</label>
                <select id="monthFilter">
                    <option value="all">전체</option>
                </select>
            </div>

            <!-- 거래처 관련 필터 -->
            <div class="filter-group">
                <label>거래처코드:</label>
                <select id="clientCodeFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>거래처명(러):</label>
                <select id="clientNameFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>내수/수출:</label>
                <select id="domesticExportFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>나라:</label>
                <select id="countryFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>지역(수출나라별):</label>
                <select id="regionExportFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>대리점/연방체인:</label>
                <select id="dealerChainFilter">
                    <option value="all">전체</option>
                </select>
            </div>

            <!-- 제품 관련 필터 -->
            <div class="filter-group">
                <label>제품코드:</label>
                <select id="productCodeFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>CP/NCP:</label>
                <select id="cpncpFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>카테고리:</label>
                <select id="categoryFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>브랜드:</label>
                <select id="brandFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>맛:</label>
                <select id="tasteFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>패키지:</label>
                <select id="packageFilter">
                    <option value="all">전체</option>
                </select>
            </div>
            <div class="filter-group">
                <label>비고:</label>
                <select id="noteFilter">
                    <option value="all">전체</option>
                </select>
            </div>

            <!-- 검색 및 초기화 -->
            <div class="filter-group">
                <label>검색:</label>
                <input type="text" id="searchInput" placeholder="거래처명 또는 제품코드 검색...">
            </div>
            <div class="filter-group">
                <button id="resetFiltersBtn" class="reset-btn">필터초기화</button>
            </div>
        </div>

        <!-- 테이블 뷰 -->
        <div id="tableView" class="tab-content active">
            <div class="table-container">
                <table id="salesTable">
                    <thead>
                        <tr>
                            <!-- 판매 데이터 -->
                            <th class="sortable" data-column="date">날짜</th>
                            <th class="sortable" data-column="orderNumber">주문번호</th>
                            <th class="sortable" data-column="quantity">수량(박스)</th>
                            <th class="sortable" data-column="amount">금액(루블)</th>
                            <th class="sortable" data-column="discount">할인율(%)</th>
                            <!-- 거래처 데이터 -->
                            <th class="sortable" data-column="clientCode">거래처코드</th>
                            <th class="sortable" data-column="clientNameRu">거래처명(러)</th>
                            <th class="sortable" data-column="clientNameKr">거래처명(한)</th>
                            <th class="sortable" data-column="domesticExport">내수/수출</th>
                            <th class="sortable" data-column="country">나라</th>
                            <th class="sortable" data-column="region">지역</th>
                            <th class="sortable" data-column="dealerChain">대리점/연방체인</th>
                            <!-- 제품 데이터 -->
                            <th class="sortable" data-column="productCode">제품코드</th>
                            <th class="sortable" data-column="cpncp">CP/NCP</th>
                            <th class="sortable" data-column="salesRegion">판매지</th>
                            <th class="sortable" data-column="category">카테고리</th>
                            <th class="sortable" data-column="brand">브랜드</th>
                            <th class="sortable" data-column="taste">맛</th>
                            <th class="sortable" data-column="package">패키지</th>
                            <th class="sortable" data-column="note">비고</th>
                        </tr>
                    </thead>
                    <tbody id="salesTableBody">
                        <!-- 데이터가 JavaScript로 삽입됩니다 (20개 열) -->
                    </tbody>
                </table>
            </div>

            <div class="pagination">
                <button id="prevPage" class="page-btn">이전</button>
                <span class="page-info">
                    <span id="currentPage">1</span> / <span id="totalPages">1</span> 페이지
                </span>
                <button id="nextPage" class="page-btn">다음</button>
                <select id="itemsPerPage">
                    <option value="25">25개씩</option>
                    <option value="50">50개씩</option>
                    <option value="100" selected>100개씩</option>
                    <option value="200">200개씩</option>
                </select>
            </div>
        </div>

        <!-- 차트 뷰 -->
        <div id="chartView" class="tab-content">
            <div class="chart-section">
                <div class="chart-header">
                    <h2>📈 판매 분석</h2>
                </div>
                <div class="chart-container">
                    <div class="chart-box">
                        <h3>월별 판매 추이</h3>
                        <div id="monthlyChart" style="width: 100%; height: 400px;"></div>
                    </div>
                    <div class="chart-box">
                        <h3>지역별 판매 비중</h3>
                        <div id="regionChart" style="width: 100%; height: 400px;"></div>
                    </div>
                    <div class="chart-box">
                        <h3>제품별 판매 TOP 10</h3>
                        <div id="productChart" style="width: 100%; height: 400px;"></div>
                    </div>
                    <div class="chart-box">
                        <h3>거래처별 판매 TOP 10</h3>
                        <div id="clientChart" style="width: 100%; height: 400px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 보고서 뷰 -->
        <div id="reportView" class="tab-content">
            <div class="report-section">
                <div class="report-header">
                    <h2>📊 국가별/거래처별 YoY 비교 보고서</h2>
                    <div class="report-controls">
                        <div class="report-period-selector">
                            <label>비교 기간:</label>
                            <select id="yoyPeriodStart">
                                <option value="1">1월</option>
                                <option value="2">2월</option>
                                <option value="3">3월</option>
                                <option value="4">4월</option>
                                <option value="5">5월</option>
                                <option value="6">6월</option>
                                <option value="7">7월</option>
                                <option value="8">8월</option>
                                <option value="9">9월</option>
                                <option value="10">10월</option>
                                <option value="11" selected>11월</option>
                                <option value="12">12월</option>
                            </select>
                            <span>까지</span>
                            <button id="updateYoyReportBtn" class="filter-btn">보고서 갱신</button>
                        </div>
                        <button id="exportYoyBtn" class="export-btn">Excel 내보내기</button>
                    </div>
                </div>
                <div class="yoy-report-container">
                    <div class="yoy-table-wrapper">
                        <table id="yoyTable" class="yoy-table">
                            <thead>
                                <tr>
                                    <th rowspan="2">국가</th>
                                    <th rowspan="2">거래처</th>
                                    <th rowspan="2">25년 목표<br>(백만 루블)</th>
                                    <th colspan="3">1-N월 누적 (백만 루블)</th>
                                    <th colspan="2">12월 (백만 루블)</th>
                                    <th rowspan="2">목표달성<br>(%)</th>
                                    <th rowspan="2">잔여매출<br>(백만 루블)</th>
                                    <th rowspan="2">오더확정액<br>(백만 루블)</th>
                                    <th rowspan="2">비고</th>
                                </tr>
                                <tr>
                                    <th>24년</th>
                                    <th>25년</th>
                                    <th>증감 (%)</th>
                                    <th>24년</th>
                                    <th>25년</th>
                                </tr>
                            </thead>
                            <tbody id="yoyTableBody">
                                <tr>
                                    <td colspan="12" style="text-align: center; padding: 40px; color: var(--secondary-color);">
                                        "보고서 갱신" 버튼을 클릭하여 YoY 보고서를 생성하세요
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
